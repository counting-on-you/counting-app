(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{140:function(e,t,a){e.exports=a(346)},145:function(e,t,a){},147:function(e,t,a){},346:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(37),o=a.n(i),l=(a(145),a(10)),c=a(11),s=a(14),u=a(12),m=a(13),d=(a(147),a(101));d.initializeApp({apiKey:"AIzaSyCwGf_7Bo5XkOJ16qnv7hdOJM_5GsoQx6M",authDomain:"counting-on-you-87316.firebaseapp.com",databaseURL:"https://counting-on-you-87316.firebaseio.com",projectId:"counting-on-you-87316",storageBucket:"counting-on-you-87316.appspot.com",messagingSenderId:"51926325505"});var g,f,p,h,b,y,j,O=d,E=a(348),v=a(349),x=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(E.a,{className:"justify-content-center",style:{margin:0,marginTop:20,paddingBottom:20}},r.a.createElement(v.a,{xs:"auto"},r.a.createElement(q,Object.assign({},this.props,{title:"Campus Total"})),r.a.createElement(G,Object.assign({buildingData:this.props.buildingData},this.props))))}}]),t}(n.Component),k=a(55),D=a(350),w=a(351),C=a(352),B=a(353),N=a(354),S=a(355),L=a(356),R=a(138),T=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).toggle=a.toggle.bind(Object(k.a)(Object(k.a)(a))),a.state={isOpen:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){var e=this,t=this.state.isOpen;return r.a.createElement("div",null,r.a.createElement(D.a,{style:{backgroundColor:"#B39DDB"}},r.a.createElement(w.a,{href:"https://counting-on-you.github.io/counting-app/",className:"font-headercolor"},"Counting On You"),r.a.createElement(C.a,{className:"ml-auto",style:{alignItems:"center"},navbar:!0},r.a.createElement(B.a,null,t?r.a.createElement(N.a,null,r.a.createElement(S.a,null,r.a.createElement(L.a,{type:"text",name:"search",id:"search",placeholder:"Search for a building",onBlur:function(){e.setState({isOpen:!1})}}))):r.a.createElement(R.a,{onClick:function(){e.setState({isOpen:!0})}})))))}}]),t}(r.a.Component),A=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.match,t=this.props.data?this.props.data[e.params.id]:null;if(t){console.log(t);var a=t.floors;return r.a.createElement(v.a,{style:{marginTop:10,paddingBottom:10}},r.a.createElement(q,Object.assign({},this.props,{id:e.params.id,title:t.name})),r.a.createElement(V,{floorData:a,bid:e.params.id}))}return r.a.createElement(E.a,{className:"justify-content-md-center"},r.a.createElement(v.a,{xs:"auto"},"Loading ..."))}}]),t}(n.Component),_=a(36),M=a(357),z=a(358),H=a(359),W=a(360),J=a(20),I=a(9),q=Object(J.b)("dataStore")(g=Object(J.c)(g=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={selected:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this,a=this.state.selected,n=this.props.id;return e=n&&this.props.dataStore.aggregate[n]?Object(_.a)(this.props.dataStore.aggregate[n].chartData):Object(_.a)(this.props.dataStore.aggregate.campus.chartData),r.a.createElement(v.a,{style:{paddingLeft:0,paddingRight:0}},r.a.createElement(M.a,{className:"w-100 color-lightgray"},r.a.createElement(z.a,{className:"w-100"},r.a.createElement(H.a,{className:"font-white",style:{fontSize:20}},this.props.title)),r.a.createElement("div",{className:"d-flex justify-content-center w-100",style:{paddingRight:10,paddingLeft:10}},r.a.createElement(Y,{data:e,selected:a})),r.a.createElement(z.a,null,r.a.createElement("div",{className:"d-flex flex-row-reverse justify-content-center"},r.a.createElement(W.a,{color:3===a?"primary":"link",className:"color-lightgray font-white",style:{marginRight:5,marginLeft:5},onClick:function(){t.setState({selected:3})}},"1M"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:2===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){t.setState({selected:2})}},"1W"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:1===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){t.setState({selected:1})}},"1D"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:0===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){t.setState({selected:0})}},"1H")))))}}]),t}(n.Component))||g)||g,Q=a(361),F=a(362),P=a(363),G=Object(J.b)("dataStore")(f=Object(J.c)(f=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.buildingData,a=3*Math.random(),n=a>1?a>2?"Busy":"Normal":"Quiet";return t?r.a.createElement(v.a,null,r.a.createElement(E.a,{id:"title",className:"justify-content-center font-white",style:{marginTop:10,marginBottom:2,fontSize:20}},"Buildings"),r.a.createElement(E.a,null,r.a.createElement(Q.a,{className:"w-100"},t.map(function(t){var a=t.id,i=e.props.dataStore.aggregate[a]?Object(_.a)(e.props.dataStore.aggregate[a].chartData):[];return r.a.createElement(F.a,{key:a,className:"color-lightgray"},r.a.createElement(P.a,{to:"/building/".concat(a)},r.a.createElement("div",{className:"d-flex flex-direction-row justify-content-between align-items-center font-white"},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement("div",null,t.name),r.a.createElement("small",{className:"font-busycolor"},n)),r.a.createElement("div",null,r.a.createElement(Z,{data:i})))))})))):r.a.createElement(v.a,null,r.a.createElement(E.a,{id:"title"},"Buildings"),r.a.createElement(E.a,null,"No data yet"))}}]),t}(n.Component))||f)||f,K=a(72),U=a(38),X=a.n(U),Y=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).formatDate=function(e,t){var a=1e3*Number(e);return X()(a).format("h:mma")},a.filterData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=Math.floor(Date.now()/1e3),n=a;return 0===t&&(n=a-3600),1===t&&(n=a-86400),2===t&&(n=a-604800),3===t&&(n=a-18748800),e.filter(function(e){return Number(e.x)>n})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,a=this.props.selected,n=this.filterData(t,a);return r.a.createElement("div",null,r.a.createElement(K.a,{data:{labels:n.map(function(t){return e.formatDate(t.x,a)}),datasets:[{label:"Timestamp",fill:!1,lineTension:.2,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"#B39DDB",borderCapStyle:"round",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"#B39DDB",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"#B39DDB",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:n}]},options:{legend:{display:!1},tooltips:{enabled:!1},scales:{xAxes:[{ticks:{display:!0,fontColor:"#c0c0c0"},gridLines:{color:"#424242"}}],yAxes:[{ticks:{display:!1},gridLines:{color:"#424242"}}]}}}))}}]),t}(r.a.Component),$=a(73),V=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).toggle=function(){a.setState({collapse:!a.state.collapse})},a.state={collapse:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.floorData,a=e.bid;this.state.collapse;return console.log(t),t?(console.log(t),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{id:"title",className:"justify-content-center font-white",style:{marginTop:10,marginBottom:2,fontSize:20}},"Floors"),r.a.createElement(E.a,null,r.a.createElement(v.a,null,r.a.createElement(Q.a,null,Object.keys(t).map(function(e){return r.a.createElement(ee,{key:e,floorData:Object($.a)({},t[e],{id:a+"_"+e}),floorStatus:"Busy"})})))))):r.a.createElement(v.a,null,r.a.createElement(E.a,{id:"title"},"Floors"),r.a.createElement(E.a,null,"Loading ..."))}}]),t}(n.Component),Z=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).filterData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=Math.floor(Date.now()/1e3),n=a;return 0===t&&(n=a-3600),1===t&&(n=a-86400),2===t&&(n=a-604800),3===t&&(n=a-18748800),e.filter(function(e){return Number(e.x)>n})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.data||[{x:"1548519420",y:12},{x:"1548519720",y:12},{x:"1548520020",y:12},{x:"1548520320",y:12},{x:"1548520620",y:12},{x:"1548520920",y:12},{x:"1548521220",y:12},{x:"1548521520",y:12},{x:"1548521820",y:12},{x:"1548522120",y:12},{x:"1548522420",y:12},{x:"1548522720",y:12},{x:"1548523800",y:12},{x:"1548524100",y:12},{x:"1548524400",y:12},{x:"1548524700",y:12},{x:"1548525000",y:12},{x:"1548525300",y:12},{x:"1548525600",y:12},{x:"1548525900",y:12},{x:"1548526200",y:12},{x:"1548526500",y:12},{x:"1548526800",y:12},{x:"1548527100",y:12},{x:"1548527400",y:12},{x:"1548527700",y:12},{x:"1548528000",y:12},{x:"1548528300",y:12},{x:"1548528600",y:12},{x:"1548528900",y:12},{x:"1548529200",y:12},{x:"1548529500",y:12},{x:"1548529800",y:12},{x:"1548530100",y:12},{x:"1548530400",y:12},{x:"1548530700",y:12},{x:"1548531000",y:12},{x:"1548548640",y:6},{x:"1548548940",y:30},{x:"1548549000",y:74},{x:"1548549300",y:98},{x:"1548549600",y:86},{x:"1548549900",y:42},{x:"1548550140",y:104},{x:"1548550200",y:115},{x:"1548552060",y:34},{x:"1548552360",y:100},{x:"1548552660",y:46}],t=this.props.selected,a=this.filterData(e,t);return r.a.createElement("div",null,r.a.createElement(K.a,{data:{labels:[a],datasets:[{fill:!1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"#B39DDB",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"#B39DDB",pointBackgroundColor:"#fff",pointBorderWidth:1,pointRadius:1,responsive:!0,data:a}]},width:100,height:50,options:{maintainAspectRatio:!1,legend:{display:!1},tooltips:{enabled:!1},scales:{xAxes:[{ticks:{display:!1},gridLines:{color:"rgba(0, 0, 0, 0)"}}],yAxes:[{ticks:{display:!1},gridLines:{color:"rgba(0, 0, 0, 0)"}}]}}}))}}]),t}(r.a.Component),ee=Object(J.b)("dataStore")(p=Object(J.c)(p=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).toggle=function(){a.setState({collapse:!a.state.collapse})},a.state={collapse:!1,selected:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=(t.collapse,t.selected),n=this.props,i=n.floorData,o=(n.floorStatus,i.name),l=i.id,c=3*Math.random(),s=c>1?c>2?"Busy":"Normal":"Quiet",u=this.props.dataStore.aggregate[l]?Object(_.a)(this.props.dataStore.aggregate[l].chartData):[];return r.a.createElement(v.a,null,r.a.createElement(E.a,null,r.a.createElement(Q.a,{className:"w-100"},r.a.createElement(F.a,{className:"color-lightgray font-white",style:{marginBottom:10}},r.a.createElement("div",{className:"d-flex flex-direction-row justify-content-between",onClick:this.toggle},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement("div",null,o)),r.a.createElement("div",null,r.a.createElement("div",{className:"font-busycolor"},s))),r.a.createElement("div",{className:"d-flex justify-content-center w-100",style:{paddingRight:10,paddingLeft:10}},r.a.createElement(Y,{data:u,selected:a})),r.a.createElement("div",{className:"d-flex flex-row-reverse justify-content-center"},r.a.createElement(W.a,{color:3===a?"primary":"link",className:"color-lightgray font-white",style:{marginRight:5,marginLeft:5},onClick:function(){e.setState({selected:3})}},"1M"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:2===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){e.setState({selected:2})}},"1W"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:1===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){e.setState({selected:1})}},"1D"),r.a.createElement(W.a,{style:{marginRight:5,marginLeft:5},color:0===a?"primary":"link",className:"color-lightgray font-white",onClick:function(){e.setState({selected:0})}},"1H"))))))}}]),t}(n.Component))||p)||p,te=a(364),ae=a(366),ne=a(365),re=a(74),ie=a(77),oe=a(78),le=(a(343),h=function e(){Object(l.a)(this,e),Object(ie.a)(this,"pi_map",b,this),Object(ie.a)(this,"aggregate",y,this),Object(ie.a)(this,"aggregateTimestamps",j,this)},b=Object(oe.a)(h.prototype,"pi_map",[I.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),y=Object(oe.a)(h.prototype,"aggregate",[I.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{campus:{counter:0,uniqueCount:0,ids:{},data:{},chartData:[]}}}}),j=Object(oe.a)(h.prototype,"aggregateTimestamps",[I.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=e.aggregate[a]||{counter:0,uniqueCount:0,ids:{},data:{},chartData:[]};n.counter++,n.ids[a]=!0,n.uniqueCount=Object.keys(n.ids),Object.keys(t).forEach(function(e){var a=600*Math.floor(Number(e)/600),r=n.data[a]||0;n.data[a]=r+t[e].length}),n.chartData=Object.keys(n.data).map(function(e){return{x:e,y:n.data[e]}}),e.aggregate=Object($.a)({},e.aggregate,Object(re.a)({},a,n))}}}),h),ce=(a(344),new le),se=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).syncData=function(){console.log("Called syncData"),a.buildingRef.on("value",function(e){var t=e.val();console.log(t),a.setState({data:t}),a.fetchPiData(),console.log(t),a.getBuildingList(t)})},a.getBuildingList=function(e){var t=Object.keys(e).map(function(t){return{name:e[t].name,id:t}});a.setState({buildingData:t})},a.fetchPiData=function(){var e=[];Object.keys(a.state.data).forEach(function(t){var n=a.state.data[t].floors;Object.keys(n).forEach(function(a){var r=n[a].pi_ids;if(r){var i=Object.keys(r).map(function(e){return{piid:e,bid:t,fid:t+"_"+a}});e=e.concat(i)}})}),ce.pi_map={},e.forEach(function(e){a.db.ref("/data/").child(e.piid).on("value",function(t){var a=t.val();a&&(ce.pi_map[e.piid]=a,ce.aggregateTimestamps(a,e.fid),ce.aggregateTimestamps(a,e.bid),ce.aggregateTimestamps(a,"campus"),console.log(Object(I.m)(ce.aggregate)),console.log(Object(I.m)(ce.pi_map)))})})},a.getPiDataQuery=function(e,t){var n=Date.now()/1e3-3600;return a.db.ref("/data/").child(e).orderByKey().endAt(""+n)},a.db=O.database(),a.buildingRef=a.db.ref("/building/"),a.state={data:null},a.syncData(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(te.a,{basename:"https://counting-on-you.github.io/counting-app/"},r.a.createElement(J.a,{dataStore:ce},r.a.createElement("div",{style:{flex:1},className:"color-darkgray"},r.a.createElement(T,null),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{path:"/building/:id",render:function(t){return r.a.createElement(A,Object.assign({},t,{data:e.state.data}))}}),r.a.createElement(ne.a,{path:"/",render:function(t){return r.a.createElement(x,Object.assign({},t,{buildingData:e.state.buildingData}))}})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[140,2,1]]]);
//# sourceMappingURL=main.479bd922.chunk.js.map